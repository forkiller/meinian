<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.atguigu.dao.MemberDao">
    <!--新增会员-->
    <!--生成id 返回给 对象,selectKey 处理高并发情况？-->
    <insert id="add">
        <selectKey resultType="java.lang.Integer" order="AFTER" keyProperty="id">
            select last_insert_id()
        </selectKey>
        insert into t_member (name, sex, idCard, phoneNumber, regTime)
        values (#{name}, #{sex}, #{idCard}, #{phoneNumber}, #{regTime});
    </insert>
    <select id="findMemberByTelephone" resultType="com.atguigu.pojo.Member">
        select *
        from t_member
        where phoneNumber=#{telephone}
    </select>

    <select id="findMemberCountBeforeDate" resultType="java.lang.Integer">
        select count(1)
        from t_member tm
        where tm.regTime &lt; #{lastDayOfMonth};
    </select>
    <select id="getTodayNewMember" resultType="java.lang.Integer">
        select count(1)
        from t_member
        where regTime=#{today}
    </select>
    <select id="getThisWeekNewMember" resultType="java.lang.Integer">
        select count(1)
        from t_member m
        where m.regTime > #{weekMonday};
    </select>
    <select id="getTotalMember" resultType="java.lang.Integer">
        select count(1)
        from t_member
    </select>
    <select id="getThisMonthNewMember" resultType="java.lang.Integer">
        select count(1)
        from t_member m
        where m.regTime between #{monthFirst} and #{monthLast};
    </select>
</mapper>